## 使用BS模型模拟交易策略
我们使用BS模型预测的期权价格，通过滑动窗口滚动计算其移动平均值、标准差，再使用移动平均值和标准差的数值构建布林带通道，计算公式如下：

![image](https://github.com/kx-c/BSmodel/blob/main/%E6%8D%95%E8%8E%B7.JPG)

布林带通道通过计算移动平均值和标准差来对原始数据进行平滑处理，处理过后的数据相较原始数据走势更平稳，上式中的upper bound又被称为压力线，lower bound又被称为支撑线。通常情况下，在真实的交易情景中，人们往往使用政权历史收盘价数据来构建布林带通道，决策时多采用追涨杀跌的策略，即当证券价格突破压力线时，进行买入操作，跌破支撑线时，执行卖出操作。
此处，我们将滑动窗口大小n设为10天，移动标准差σ的系数a设为0.5，根据上述公式计算出上下均线后与期权真实价格一同作图显示，结果如下：

![image](https://github.com/kx-c/BSmodel/blob/main/MA-1.JPG)

可以看到，由于模型预测价格在低位是表现出对股票价格的低估，因此在进行平滑处理后，构建的布林带通道也处于真实价格的下方。我们利用构建的布林带进行择时交易，得到交易信号量，当执行买入或处于买入状态时操作时，信号量为1，执行卖出操作或处于卖出状态时，信号量为-1，交易信号量变化趋势如下：

![image]()

可以看到，由于模型对期权价格的低估，交易执行并不频繁。此处，我们将手续费设为0.001，和市场平均保持一致，并计算累计收益率。由于策略的指制定需要用到收盘价数据，投资者只能在次日执行买卖操作，故为了防止未来数据干扰实验效果，我们使用历史开盘价计算策略的累计收益率，计算方法为：回报率 = 后日收盘价 / 次日收盘价 - 1，收益率 = 交易信号量 * （回报率 - 手续费） + 1。我们将使用策略和持有的当日收益率作图显示：

![image]()

从图中我们容易看到，基于BS预测定价的布林带策略表现并不够理想，虽然在7月至8月时有过短暂的收益率高峰，但回撤幅度同样较大，行权前夕累计收益率表现有时会出现低于直接持有的现象。出现这种现象的原因可能有：

· BS模型对期权价格的低估
· 布林带通道的参数设置不当
· 策略本身不适用于该模型预测交易

之后，我们使用多组取值对参数：滑动窗口天数、移动标准差系数α进行调整，得出的结果与前述策略相似，由于真实交易过程中无法获知未来数据，人们通常使用较为常用的参数组合，故很难出现使用极端取值，由结果来拟合提升收益率的现象，故可一定程度上排除参数选取不当的因素。



## 反推隐含波动率构建交易策略

根据之前列出的Black Scholes公式，我们通过使用证券交易价格、行权价格、有效期、无风险利率、年化波动率推算出期权当日的合理价格。计算隐含波动率，即使用期权真实交易价格替代模型预测结果，反推波动率。由于此处波动率的计算没有显式的表达式可以实现，故只能采用迭代调整的方法逼近真实结果，下图为采用二分法计算出的隐含波动率数据和滑动窗口为10天的ETF50收盘价移动标准差的变化趋势。

![image]()

如图，可以看到相较于基金真实价格的波动率，隐含波动率的波动更加明显。

同样对隐含波动率使用布林带择时策略，此处，滑动窗口大小设为20天，σ系数α设为1，通道与原始数据作图显示如下：

![image]()

与前述策略不同的是，波动率的以小为宜，当隐含波动率突破压力线时，即隐含波动率处于高位，执行卖出操作，反之当隐含波动率跌破支撑线时，代表波动率处于低位，执行买入操作，同样计算交易信号，走势如下图：

![image]()

相比于预测价格布林带策略，隐含波动率策略的交易更加频繁，当我们将系数α缩小为0.5时，买卖操作会更加频繁，但对整体的累计收益率影响不大。


交易结果、图片、累计收益率、以及原因分析：隐含波动率计算时出现的问题
